<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="squire.page">
<title>Nimue rewrite: Booster Pathway • squire.page</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Nimue rewrite: Booster Pathway">
<meta property="og:description" content="squire.page">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">squire.page</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/booster_pathway.html">Nimue rewrite: Booster Pathway</a>
    <a class="dropdown-item" href="../articles/difference_model.html">Booster Model: Difference Model</a>
    <a class="dropdown-item" href="../articles/rt_optimise.html">New Fitting Method: Rt Optimisation</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="booster_pathway_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Nimue rewrite: Booster Pathway</h1>
            
      
      
      <div class="d-none name"><code>booster_pathway.Rmd</code></div>
    </div>

    
    
<p>This vignette describes the rewritten <em>nimue</em> booster pathway. This update allows the inclusion of booster doses to vaccination campaigns in the <em>nimue</em> model and allows explicit inclusion of first and second dose efficacies. No changes are made to the infection and hospitalisation pathway.</p>
<div class="section level2">
<h2 id="model-structure">Model Structure<a class="anchor" aria-label="anchor" href="#model-structure"></a>
</h2>
<p><img src="Nimue_Booster_Diagram.png" width="400px" style="display: block; margin: auto;"></p>
<p>Compartment definitions are as follows:</p>
<ul>
<li>
<span class="math inline">\(uV\)</span> Un-vaccinated population,</li>
<li>
<span class="math inline">\(pV_i\)</span> Partially vaccinated/protected population (i.e. first dose of a two dose regimen),</li>
<li>
<span class="math inline">\(fV_i\)</span> Fully vaccinated/protected population (i.e. both doses of a two dose regimen).</li>
<li>
<span class="math inline">\(bV_i\)</span> Boosted population (at least one booster dose).</li>
</ul>
<p>Full dose and boosted compartments both feed into waned compartments that represent reduced vaccine efficacy over time. Transition rates are defined as:</p>
<ul>
<li>
<span class="math inline">\(fD_t\)</span> Daily time-series of first doses,</li>
<li>
<span class="math inline">\(sD_t\)</span> An inferred delay between doses (~60 days),</li>
<li>
<span class="math inline">\(bD_{1,t}\)</span> Daily time-series of initial booster doses,</li>
<li>
<span class="math inline">\(bD_{2,t}\)</span> Daily time-series of follow-up booster doses, can be limited to certain age groups,</li>
<li>
<span class="math inline">\(w_p\)</span> Rate of waning of initial dose protection,</li>
<li>
<span class="math inline">\(w_i\)</span> Rate of waning of boosted dose protection.</li>
</ul>
<p>Eligibility for follow-up boosters can be restricted to certain age groups with the parameter <code>vaccine_booster_follow_up_coverage</code>.</p>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>The user is expected to provide a time-series of primary doses, and booster doses. This model is primarily for usage in the <em>global_lmic_reports</em>, and so it not intended for normal usage. The objects necessary for MCMC fitting can be access as so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#model object</span></span>
<span><span class="fu">squire.page</span><span class="fu">::</span><span class="fu"><a href="../reference/nimue_booster_model.html">nimue_booster_model</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#likelihood function</span></span>
<span><span class="fu">squire.page</span><span class="fu">::</span><span class="fu">calc_loglikelihood_booster</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#pmcmc object</span></span>
<span><span class="fu">squire.page</span><span class="fu">::</span><span class="fu">pmcmc_drjacoby</span><span class="op">(</span>log_likelihood <span class="op">=</span> <span class="fu">squire.page</span><span class="fu">::</span><span class="va">calc_loglikelihood_booster</span>,</span>
<span>                            nimue_booster_model <span class="op">=</span> <span class="fu">squire.page</span><span class="fu">::</span><span class="va"><a href="../reference/nimue_booster_model.html">nimue_booster_model</a></span>,</span>
<span>                            <span class="va">...</span> <span class="co">#specific arguments here</span></span>
<span>                            <span class="op">)</span></span>
<span><span class="co">#alternatively</span></span>
<span><span class="fu"><a href="../reference/rt_optimise.html">rt_optimise</a></span><span class="op">(</span>squire_model <span class="op">=</span> <span class="fu">squire.page</span><span class="fu">::</span><span class="fu"><a href="../reference/nimue_booster_model.html">nimue_booster_model</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            <span class="va">...</span> <span class="co">#Parameter arguments here</span></span>
<span>            <span class="op">)</span></span></code></pre></div>
<p>The model can be run as in <em>squire</em> or <em>nimue</em> with the non-exported function <code>squire.page:::run_booster</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">squire.page</span><span class="fu">:::</span><span class="fu">run_booster</span><span class="op">(</span></span>
<span>  country <span class="op">=</span> <span class="st">"United Kingdom"</span>,</span>
<span>  primary_doses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span>, <span class="fl">500</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  tt_primary_doses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">50</span>, <span class="fl">150</span><span class="op">)</span>,</span>
<span>  second_dose_delay <span class="op">=</span> <span class="fl">60</span>,</span>
<span>  booster_doses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">500</span>, <span class="fl">750</span><span class="op">)</span>,</span>
<span>  tt_booster_doses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">200</span>, <span class="fl">400</span><span class="op">)</span>,</span>
<span>  time_period  <span class="op">=</span> <span class="fl">365</span><span class="op">*</span><span class="fl">2</span>,</span>
<span>  vaccine_booster_follow_up_coverage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">17</span> <span class="op">-</span> <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">squire.page</span><span class="fu">::</span><span class="fu"><a href="../reference/nimue_format.html">nimue_format</a></span><span class="op">(</span>var_select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vaccinated_first_dose"</span>, <span class="st">"vaccinated_second_dose"</span>, <span class="st">"vaccinated_second_waned"</span>,</span>
<span>                                           <span class="st">"vaccinated_booster_dose"</span>, <span class="st">"vaccinated_booster_waned"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">tibble</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">compartment</span>, values_from <span class="op">=</span> <span class="va">y</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">transmute</span><span class="op">(</span></span>
<span>    t <span class="op">=</span> <span class="va">t</span>,</span>
<span>    `Partial` <span class="op">=</span> <span class="va">vaccinated_first_dose</span> <span class="op">-</span> <span class="va">vaccinated_second_dose</span>,</span>
<span>    `Primary` <span class="op">=</span> <span class="va">vaccinated_second_dose</span> <span class="op">-</span> <span class="va">vaccinated_booster_dose</span> <span class="op">-</span> <span class="va">vaccinated_second_waned</span>,</span>
<span>    `Waned (Primary)` <span class="op">=</span> <span class="va">vaccinated_second_waned</span>,</span>
<span>    `Boosted` <span class="op">=</span> <span class="va">vaccinated_booster_dose</span> <span class="op">-</span> <span class="va">vaccinated_booster_waned</span>,</span>
<span>    `Waned (Boosted)` <span class="op">=</span> <span class="va">vaccinated_booster_waned</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">`Partial`</span>, <span class="va">`Primary`</span>,</span>
<span>    <span class="va">`Waned (Primary)`</span>,</span>
<span>    <span class="va">`Boosted`</span>,</span>
<span>    <span class="va">`Waned (Boosted)`</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"Vaccine Protection"</span>, values_to <span class="op">=</span> <span class="st">"Population"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">t</span>, y <span class="op">=</span> <span class="va">`Population`</span>, colour <span class="op">=</span> <span class="va">`Vaccine Protection`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="booster_pathway_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;"></p>
<p>As the delay in development of vaccination protection from nimue is removed, the time-series for first/second doses provided to the model if internally adjusted via an Erlang distribution with shape 2 and rate 1/7 to simulate this effect. These parameters are customizable in the model.</p>
<p>To simulate a primary single dose vaccine (i.e. Janssen) set both first and second dose efficacies to the same desired level and set the second dose delay to 1.</p>
</div>
<div class="section level2">
<h2 id="parameterisation">Parameterisation<a class="anchor" aria-label="anchor" href="#parameterisation"></a>
</h2>
<p>Default parameter values are chosen to be representative for the vaccination programmes of LMIC and LIC countries and against the wild-type variant and as such represent no single vaccine but are chosen from a range of values to represent roughly the Adenovirus, Whole Virus, and Subunit vaccines. Note that for work involving these efficacies against Delta and Omicron are calculated elsewhere.</p>
<p>Vaccine Efficacies:</p>
<p>Waning Rates:</p>
<ul>
<li>
<span class="math inline">\(w_p\)</span> = 0.007466205 (134 days)</li>
<li>
<span class="math inline">\(w_1\)</span> = 0.00807429 (123.8 days)</li>
<li>
<span class="math inline">\(w_2\)</span> = 0.03331390 (30 days)</li>
</ul>
<p>Delay in second dose protection is assumed to be 60 days.</p>
<p>To calculate these values we utilised an approach taken previously with waning vaccine efficacy via AB titres (<a href="https://www.imperial.ac.uk/mrc-global-infectious-disease-analysis/covid-19/report-48-global-omicron/" class="external-link">Report 48</a>). We took our assumed non-waned efficacies and then created an median waning curve from these values. Then we fit the waning rates and waned compartment values to recreate these curves. The plots of these fits are shown below.</p>
<p><img src="fitted_value_plot.png" width="600px" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="comparison-to-nimue">Comparison to nimue<a class="anchor" aria-label="anchor" href="#comparison-to-nimue"></a>
</h2>
<p>Comparing the two models in the absence of vaccinations should give identical results, outside of minor variations due to the random ages of the initial infections.</p>
<p><img src="booster_pathway_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Comparing the two models with only primary doses (with a flat efficacy for first/second) and no waning should also be identical</p>
<p><img src="booster_pathway_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></p>
<p>With waning we would expect to see some minor difference as the booster only has a single compartment to represent primary dose waning, though with the same overall rates they should be similar.</p>
<p><img src="booster_pathway_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
<p>In the plot above we increase the duration of waning in nimue by 14 days to account for the fact that in the booster model the 14 day delay in developing VE is applied for both first and second doses. Otherwise the second peak occurs a couple of days sooner in nimue.</p>
<p>To simulate two doses we first consider the situation with a delay of 60 days between the two, for nimue this is translated into a dose ratio and the VE are scaled. Again for nimue we must increase the duration of protection to account for the delay between doses.</p>
<p><img src="booster_pathway_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Lastly including boosters in the booster model, we would expect a delay in deaths until waning overwhelms.</p>
<p><img src="booster_pathway_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Gregory Barnsley.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
